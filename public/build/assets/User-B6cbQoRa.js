import{_ as w,E as S,c as o,a as s,e as k,f as l,v as h,t as d,g as i,h as g,F as v,i as C,d as y,b as p,w as m,T as b,o as r}from"./app-jXeI2irY.js";const V={mixins:[S],data:function(){return{data:{},pharmacies:[],password:null,passwordFieldVisible:!1,passwordSecurityStatus:!1,code:"",authorizable:!1,passwordFieldVisible:!1,emailFieldVisible:!1,loginCodeVisible:!1,loading:!1,errors:{},userInfo}},mounted(){this.getPharmacies(),userInfo.id!=this.$route.params.id&&userInfo.role<30?this.$router.push("/notallowed"):(this.getData(),this.getPasswordSecurityStatus())},computed:{tableUrl:function(){return"/inventory/user/"+this.$route.params.id},dataUrl:function(){return"/users/"+this.$route.params.id},postUrl:function(){return"/users/"+this.$route.params.id},loginAsUrl:function(){return"/login_as/"+this.$route.params.id}},methods:{getData:function(){this.loading=!0,axios.get(this.dataUrl).then(e=>{this.data=e.data.data.userData,this.loading=!1}).catch(e=>{this.reportError(e)})},getPasswordSecurityStatus:function(e){axios.get(`/users/${this.$route.params.id}/2fa-status`).then(t=>{this.passwordSecurityStatus=t.data.data,this.passwordSecurityStatus&&axios.get(`/users/${this.$route.params.id}/2fa-code`).then(u=>{this.code=u.data.data})}).catch(t=>{this.reportError(t)})},enable2fa:function(){axios.post(`/users/${this.$route.params.id}/2fa-enable`).then(()=>{this.getPasswordSecurityStatus()}).catch(e=>{this.reportError(e)})},disable2fa:function(){axios.post(`/users/${this.$route.params.id}/2fa-disable`).then(()=>{this.getPasswordSecurityStatus()}).catch(e=>{this.reportError(e)})},getPharmacies(){axios.get("/pharmacies/list").then(e=>{this.pharmacies=e.data.data}).catch(e=>{this.reportError(e)})},togglePasswordChange:function(){this.passwordFieldVisible=!this.passwordFieldVisible},toggleEmailChange:function(){this.emailFieldVisible=!this.emailFieldVisible},toggleLoginCodeChange:function(){this.loginCodeVisible=!this.loginCodeVisible},update:function(){this.loading=!0;let e={name:this.data.name,pharmacy_id:this.data.pharmacy_id,surname:this.data.surname,email:this.data.email,role:this.data.role,code:this.data.code};this.password&&(e.password=this.password),axios.post(this.postUrl,e).then(t=>{this.postSuccess(t.data.message),this.errors={},this.loading=!1}).catch(t=>{this.errors=t.response.data.errors,this.loading=!1})},loginAs:function(){axios.get(this.loginAsUrl).then(e=>{location.reload()}).catch(e=>{console.warn(e)})},generateCode(e){for(var t="",u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789$%()[]?!:@/",f=u.length,c=0;c<e;c++)t+=u.charAt(Math.floor(Math.random()*f));return t},storeCode(){this.data.code=this.generateCode(14)}}},U={class:"content"},_={class:"card"},B=s("div",{class:"card-header"},[s("h3",null,"User details")],-1),z={class:"card-body"},E=s("p",{class:"h4 mb-3"},"User details",-1),F={key:0,class:"invalid-feedback d-block"},P={key:1,class:"invalid-feedback d-block"},A=s("br",null,null,-1),D=s("label",null,"Role",-1),I=s("br",null,null,-1),L=s("option",{value:"5"},"Shipping",-1),T={key:0,value:"30"},M={key:1,value:"50"},N={key:2,value:"60"},$=s("br",null,null,-1),H=s("label",null,"Pharmacy",-1),R=s("br",null,null,-1),j=["value"],G={key:2,class:"invalid-feedback d-block"},Q=s("br",null,null,-1),q={style:{display:"flex","flex-direction":"column",width:"100%","align-items":"center","justify-content":"center"}},J={key:0},K={key:1},O={key:0},W=["innerHTML"],X=s("p",null,"This QR code can be scanned by an authenticator app to start using it.",-1),Y=s("br",null,null,-1),Z={key:1,class:"invalid-feedback d-block"},x={key:0,class:"input-group mb-3"},ee={class:"input-group-append",style:{display:"inline"}},te={key:1,class:"invalid-feedback d-block"},se=s("br",null,null,-1),ae={key:1,class:"invalid-feedback d-block"},oe=s("br",null,null,-1),re=s("button",{class:"btn btnSize01 secondaryBtn",type:"submit"},"Update",-1);function ie(e,t,u,f,c,n){return r(),o("div",U,[s("section",_,[B,s("div",z,[s("form",{class:"text-center p-5",onSubmit:t[14]||(t[14]=k((...a)=>n.update&&n.update(...a),["prevent"]))},[E,l(s("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>e.data.name=a),type:"text",id:"name",class:"form-control tBoxSize02 mb-10",placeholder:"Name"},null,512),[[h,e.data.name]]),e.errors.name?(r(),o("div",F,d(e.errors.name[0]),1)):i("",!0),l(s("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>e.data.surname=a),type:"text",id:"surname",class:"form-control tBoxSize02 mb-10",placeholder:"Surname"},null,512),[[h,e.data.surname]]),e.errors.surname?(r(),o("div",P,d(e.errors.surname[0]),1)):i("",!0),A,D,I,l(s("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>e.data.role=a),class:"browser-default custom-select mb-10"},[L,e.userInfo.role>=30?(r(),o("option",T,"Pharmacy Admin")):i("",!0),e.userInfo.role>=50?(r(),o("option",M,"Admin")):i("",!0),e.userInfo.role>=60?(r(),o("option",N,"SysAdmin")):i("",!0)],512),[[g,e.data.role]]),$,H,R,l(s("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>e.data.pharmacy_id=a),class:"browser-default custom-select mb-10"},[(r(!0),o(v,null,C(e.pharmacies,a=>(r(),o("option",{key:a.PharmacyID,value:a.PharmacyID},d(a.Title),9,j))),128))],512),[[g,e.data.pharmacy_id]]),e.errors.role?(r(),o("div",G,d(e.errors.role[0]),1)):i("",!0),Q,s("div",q,[s("p",null,[y("2FA is Currently "),e.passwordSecurityStatus?(r(),o("b",J,"Enabled")):(r(),o("b",K,"Disabled")),y(" for this account.")]),e.passwordSecurityStatus?(r(),o("div",O,[s("div",{innerHTML:e.code},null,8,W),X])):i("",!0)]),Y,p(b,{name:"fade"},{default:m(()=>[e.passwordFieldVisible?l((r(),o("input",{key:0,autocomplete:"off","onUpdate:modelValue":t[4]||(t[4]=a=>e.password=a),type:"password",name:"new-password",id:"password",class:"form-control tBoxSize02 mb-3",placeholder:"Password"},null,512)),[[h,e.password]]):i("",!0),e.errors.password?(r(),o("div",Z,d(e.errors.password[0]),1)):i("",!0)]),_:1}),p(b,{name:"fade"},{default:m(()=>[s("div",null,[e.loginCodeVisible?(r(),o("div",x,[l(s("input",{style:{margin:"0!important"},autocomplete:"off","onUpdate:modelValue":t[5]||(t[5]=a=>e.data.code=a),type:"code",name:"code",id:"code",class:"form-control tBoxSize02 mb-10",placeholder:"Login Code"},null,512),[[h,e.data.code]]),s("div",ee,[s("button",{onClick:t[6]||(t[6]=a=>n.storeCode()),class:"btn btnSize01 secondaryBtn m-0 z-depth-0 waves-effect",type:"button",id:"button-addon2"},"Generate Code")])])):i("",!0),e.errors.code?(r(),o("div",te,d(e.errors.code[0]),1)):i("",!0)])]),_:1}),se,p(b,{name:"fade"},{default:m(()=>[e.emailFieldVisible?l((r(),o("input",{key:0,"onUpdate:modelValue":t[7]||(t[7]=a=>e.data.email=a),type:"email",id:"email",class:"form-control tBoxSize02 mb-10",placeholder:"E-mail"},null,512)),[[h,e.data.email]]):i("",!0),e.errors.email?(r(),o("div",ae,d(e.errors.email[0]),1)):i("",!0)]),_:1}),oe,s("div",null,[s("button",{onClick:t[8]||(t[8]=(...a)=>n.togglePasswordChange&&n.togglePasswordChange(...a)),class:"btn btnSize01 secondaryBtn",type:"button"},"Change password"),s("button",{onClick:t[9]||(t[9]=(...a)=>n.toggleEmailChange&&n.toggleEmailChange(...a)),class:"btn btnSize01 secondaryBtn",type:"button"},"Change email"),s("button",{onClick:t[10]||(t[10]=(...a)=>n.toggleLoginCodeChange&&n.toggleLoginCodeChange(...a)),class:"btn btnSize01 secondaryBtn",type:"button"},"Change login code"),e.passwordSecurityStatus?i("",!0):(r(),o("button",{key:0,onClick:t[11]||(t[11]=(...a)=>n.enable2fa&&n.enable2fa(...a)),class:"btn btnSize01 secondaryBtn",type:"button"},"Enable 2FA")),e.passwordSecurityStatus?(r(),o("button",{key:1,onClick:t[12]||(t[12]=(...a)=>n.disable2fa&&n.disable2fa(...a)),class:"btn btnSize01 secondaryBtn",type:"button"},"Disable 2FA")):i("",!0),e.userInfo.role>=50?(r(),o("button",{key:2,onClick:t[13]||(t[13]=(...a)=>n.loginAs&&n.loginAs(...a)),class:"btn btnSize01 secondaryBtn",type:"button"},"Login as user")):i("",!0),re])],32)])])])}const le=w(V,[["render",ie]]);export{le as default};
//# sourceMappingURL=User-B6cbQoRa.js.map
